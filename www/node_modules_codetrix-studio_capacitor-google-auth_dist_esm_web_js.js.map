{"version":3,"file":"node_modules_codetrix-studio_capacitor-google-auth_dist_esm_web_js.js","mappings":"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","sources":["./node_modules/@codetrix-studio/capacitor-google-auth/dist/esm/web.js"],"sourcesContent":["import { WebPlugin } from '@capacitor/core';\nexport class GoogleAuthWeb extends WebPlugin {\n    constructor() {\n        super();\n    }\n    loadScript() {\n        if (typeof document === 'undefined') {\n            return;\n        }\n        const scriptId = 'gapi';\n        const scriptEl = document === null || document === void 0 ? void 0 : document.getElementById(scriptId);\n        if (scriptEl) {\n            return;\n        }\n        const head = document.getElementsByTagName('head')[0];\n        const script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.defer = true;\n        script.async = true;\n        script.id = scriptId;\n        script.onload = this.platformJsLoaded.bind(this);\n        script.src = 'https://apis.google.com/js/platform.js';\n        head.appendChild(script);\n    }\n    initialize(_options = {\n        clientId: '',\n        scopes: [],\n        grantOfflineAccess: false,\n    }) {\n        var _a, _b;\n        if (typeof window === 'undefined') {\n            return;\n        }\n        const metaClientId = (_a = document.getElementsByName('google-signin-client_id')[0]) === null || _a === void 0 ? void 0 : _a.content;\n        const clientId = _options.clientId || metaClientId || '';\n        if (!clientId) {\n            console.warn('GoogleAuthPlugin - clientId is empty');\n        }\n        this.options = {\n            clientId,\n            grantOfflineAccess: (_b = _options.grantOfflineAccess) !== null && _b !== void 0 ? _b : false,\n            scopes: _options.scopes || [],\n        };\n        this.gapiLoaded = new Promise((resolve) => {\n            // HACK: Relying on window object, can't get property in gapi.load callback\n            window.gapiResolve = resolve;\n            this.loadScript();\n        });\n        this.addUserChangeListener();\n    }\n    platformJsLoaded() {\n        gapi.load('auth2', () => {\n            // https://github.com/CodetrixStudio/CapacitorGoogleAuth/issues/202#issuecomment-1147393785\n            const clientConfig = {\n                client_id: this.options.clientId,\n                plugin_name: 'CodetrixStudioCapacitorGoogleAuth',\n            };\n            if (this.options.scopes.length) {\n                clientConfig.scope = this.options.scopes.join(' ');\n            }\n            gapi.auth2.init(clientConfig);\n            window.gapiResolve();\n        });\n    }\n    async signIn() {\n        return new Promise(async (resolve, reject) => {\n            var _a;\n            try {\n                let serverAuthCode;\n                const needsOfflineAccess = (_a = this.options.grantOfflineAccess) !== null && _a !== void 0 ? _a : false;\n                if (needsOfflineAccess) {\n                    const offlineAccessResponse = await gapi.auth2.getAuthInstance().grantOfflineAccess();\n                    serverAuthCode = offlineAccessResponse.code;\n                }\n                else {\n                    await gapi.auth2.getAuthInstance().signIn();\n                }\n                const googleUser = gapi.auth2.getAuthInstance().currentUser.get();\n                if (needsOfflineAccess) {\n                    // HACK: AuthResponse is null if we don't do this when using grantOfflineAccess\n                    await googleUser.reloadAuthResponse();\n                }\n                const user = this.getUserFrom(googleUser);\n                user.serverAuthCode = serverAuthCode;\n                resolve(user);\n            }\n            catch (error) {\n                reject(error);\n            }\n        });\n    }\n    async refresh() {\n        const authResponse = await gapi.auth2.getAuthInstance().currentUser.get().reloadAuthResponse();\n        return {\n            accessToken: authResponse.access_token,\n            idToken: authResponse.id_token,\n            refreshToken: '',\n        };\n    }\n    async signOut() {\n        return gapi.auth2.getAuthInstance().signOut();\n    }\n    async addUserChangeListener() {\n        await this.gapiLoaded;\n        gapi.auth2.getAuthInstance().currentUser.listen((googleUser) => {\n            this.notifyListeners('userChange', googleUser.isSignedIn() ? this.getUserFrom(googleUser) : null);\n        });\n    }\n    getUserFrom(googleUser) {\n        const user = {};\n        const profile = googleUser.getBasicProfile();\n        user.email = profile.getEmail();\n        user.familyName = profile.getFamilyName();\n        user.givenName = profile.getGivenName();\n        user.id = profile.getId();\n        user.imageUrl = profile.getImageUrl();\n        user.name = profile.getName();\n        const authResponse = googleUser.getAuthResponse(true);\n        user.authentication = {\n            accessToken: authResponse.access_token,\n            idToken: authResponse.id_token,\n            refreshToken: '',\n        };\n        return user;\n    }\n}\n"],"names":["WebPlugin","GoogleAuthWeb","constructor","loadScript","document","scriptId","scriptEl","getElementById","head","getElementsByTagName","script","createElement","type","defer","async","id","onload","platformJsLoaded","bind","src","appendChild","initialize","_options","clientId","scopes","grantOfflineAccess","_a","_b","window","metaClientId","getElementsByName","content","console","warn","options","gapiLoaded","Promise","resolve","gapiResolve","addUserChangeListener","gapi","load","clientConfig","client_id","plugin_name","length","scope","join","auth2","init","signIn","_this","_asyncToGenerator","_ref","reject","serverAuthCode","needsOfflineAccess","offlineAccessResponse","getAuthInstance","code","googleUser","currentUser","get","reloadAuthResponse","user","getUserFrom","error","_x","_x2","apply","arguments","refresh","authResponse","accessToken","access_token","idToken","id_token","refreshToken","signOut","_this2","listen","notifyListeners","isSignedIn","profile","getBasicProfile","email","getEmail","familyName","getFamilyName","givenName","getGivenName","getId","imageUrl","getImageUrl","name","getName","getAuthResponse","authentication"],"sourceRoot":"webpack:///","x_google_ignoreList":[0]}