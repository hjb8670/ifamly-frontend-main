{"version":3,"file":"src_app_pages_tabMessage_tabMessage_module_ts.js","mappings":"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","sources":["./src/app/pages/tabMessage/tabMessage-routing.module.ts","./src/app/pages/tabMessage/tabMessage.module.ts","./src/app/pages/tabMessage/tabMessage.page.ts","./src/app/pages/tabMessage/tabMessage.page.scss"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { TabMessagePage } from './tabMessage.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: TabMessagePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class TabMessagePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { TabMessagePageRoutingModule } from './tabMessage-routing.module';\n\nimport { TabMessagePage } from './tabMessage.page';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TabMessagePageRoutingModule,\n    TranslateModule\n  ],\n  declarations: [TabMessagePage]\n})\nexport class TabMessagePageModule {}\n","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { TalkService } from '../../services/talk.service';\nimport Talk from 'talkjs';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { UserService } from '../../services/user.service';\nimport { UiService } from '../../services/ui.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { MatchService } from '../../services/match.service';\n@Component({\n  selector: 'app-tabMessage',\n  templateUrl: './tabMessage.page.html',\n  styleUrls: ['./tabMessage.page.scss'],\n})\nexport class TabMessagePage implements OnInit {\n  @ViewChild('talkjsContainer') talkjsContainer!: ElementRef;\n\n\n  private inbox: Talk.Inbox;\n  private session: Talk.Session;\n  private idConversation: string;\n  public mostrarNoExiste = false;\n  public mostrarChat = false;\n\n\n  constructor(private talkService: TalkService,\n    private router: Router,\n    private activatedRoute: ActivatedRoute,\n    private userService: UserService,\n    private uiService: UiService,\n    private translate: TranslateService, \n    private matchService: MatchService\n    ) {\n      this.activatedRoute.queryParams.subscribe(params => {\n        if (this.router.getCurrentNavigation().extras.state) {\n          this.idConversation = this.router.getCurrentNavigation().extras.state.idConversation;\n          console.log('idConversation: ', this.idConversation);\n        }\n        this.createInbox();\n      });\n  }\n\n  \n  ngOnInit() {\n    \n  }\n\nasync createInbox() {\n  this.mostrarNoExiste = false;\n  this.mostrarChat = false;\n  this.uiService.showLoader();\n\n  try {\n    const user = await this.userService.getUserBasic('');\n\n    // Fallback if no conversation ID\n    if (!this.idConversation) {\n      const resp = <string[]>await this.matchService.getConversationXUsr(user.personId);\n      if (!resp || resp.length === 0) {\n        this.mostrarNoExiste = true;\n        return;\n      }\n      this.idConversation = resp[0]; // fallback to first conversation\n    }\n\n    // Create TalkJS session and inbox with custom theme\n    this.session = await this.talkService.createCurrentSession(\n      user.personId,\n      `${user.firstName} ${user.lastName}`\n    );\n\n    this.inbox = await this.session.createInbox({\n     // selected: this.session.getOrCreateConversation(this.idConversation),\n      theme: 'ifamily' // <- make sure you have this theme in dashboard\n    });\n\n    await this.inbox.mount(this.talkjsContainer.nativeElement);\n    this.mostrarChat = true;\n\n  } catch (error) {\n    console.error('Failed to create TalkJS inbox:', error);\n    this.mostrarNoExiste = true;\n  } finally {\n    this.uiService.hideLoader();\n  }\n}\n\n}\n","// Imports\nvar ___CSS_LOADER_API_SOURCEMAP_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\");\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.hdExperience {\n  background: var(--ion-color-blanco);\n  padding-bottom: 0px;\n  margin-bottom: 20px;\n}\n\nion-toolbar {\n  --background: white;\n}\n\n.titleExperience {\n  font-family: \"Sk-Modernist-Bold\";\n  font-size: 24px;\n}\n\n.ocultar {\n  display: none;\n}\n\n.txtTitle {\n  font-family: \"Sk-Modernist-Bold\";\n  font-size: 16px;\n  color: var(--ion-color-negro);\n  margin-bottom: 0;\n  text-align: center;\n}\n\n.talkjs-container {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n/* Hide chat when !mostrarChat */\n.ocultar {\n  display: none;\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/app/pages/tabMessage/tabMessage.page.scss\",\"webpack://./../../My%20Projects/frontend-ifamily/src/app/pages/tabMessage/tabMessage.page.scss\"],\"names\":[],\"mappings\":\"AAAA;EACI,mCAAA;EACA,mBAAA;EACA,mBAAA;ACCJ;;ADCA;EACI,mBAAA;ACEJ;;ADAA;EACI,gCAAA;EACA,eAAA;ACGJ;;ADAA;EACI,aAAA;ACGJ;;ADDA;EACI,gCAAA;EACA,eAAA;EACA,6BAAA;EACA,gBAAA;EACA,kBAAA;ACIJ;;ADCA;EACE,YAAA;EACA,WAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;ACEF;;ADCA,gCAAA;AACA;EACE,aAAA;ACEF\",\"sourcesContent\":[\".hdExperience {\\n    background: var(--ion-color-blanco);\\n    padding-bottom: 0px;\\n    margin-bottom: 20px;\\n}\\nion-toolbar{\\n    --background: white;\\n}\\n.titleExperience {\\n    font-family: 'Sk-Modernist-Bold';\\n    font-size: 24px;\\n}\\n\\n.ocultar{\\n    display: none;\\n}\\n.txtTitle {\\n    font-family: 'Sk-Modernist-Bold';\\n    font-size: 16px;\\n    color: var(--ion-color-negro);\\n    margin-bottom: 0;\\n    text-align: center;\\n}\\n\\n\\n\\n.talkjs-container {\\n  height: 100%;\\n  width: 100%;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n}\\n\\n/* Hide chat when !mostrarChat */\\n.ocultar {\\n  display: none;\\n}\\n\",\".hdExperience {\\n  background: var(--ion-color-blanco);\\n  padding-bottom: 0px;\\n  margin-bottom: 20px;\\n}\\n\\nion-toolbar {\\n  --background: white;\\n}\\n\\n.titleExperience {\\n  font-family: \\\"Sk-Modernist-Bold\\\";\\n  font-size: 24px;\\n}\\n\\n.ocultar {\\n  display: none;\\n}\\n\\n.txtTitle {\\n  font-family: \\\"Sk-Modernist-Bold\\\";\\n  font-size: 16px;\\n  color: var(--ion-color-negro);\\n  margin-bottom: 0;\\n  text-align: center;\\n}\\n\\n.talkjs-container {\\n  height: 100%;\\n  width: 100%;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n}\\n\\n/* Hide chat when !mostrarChat */\\n.ocultar {\\n  display: none;\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___.toString();\n"],"names":["NgModule","RouterModule","TabMessagePage","routes","path","component","TabMessagePageRoutingModule","__decorate","imports","forChild","exports","CommonModule","FormsModule","IonicModule","TranslateModule","TabMessagePageModule","declarations","Component","ViewChild","TalkService","ActivatedRoute","Router","UserService","UiService","TranslateService","MatchService","constructor","talkService","router","activatedRoute","userService","uiService","translate","matchService","mostrarNoExiste","mostrarChat","queryParams","subscribe","params","getCurrentNavigation","extras","state","idConversation","console","log","createInbox","ngOnInit","_this","_asyncToGenerator","showLoader","user","getUserBasic","resp","getConversationXUsr","personId","length","session","createCurrentSession","firstName","lastName","inbox","theme","mount","talkjsContainer","nativeElement","error","hideLoader","args","selector","template","__NG_CLI_RESOURCE__0"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}